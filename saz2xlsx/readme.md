# ğŸ“˜ SAZ2XLSX ë„êµ¬

## ì†Œê°œ
ì´ ë„êµ¬ëŠ” **Fiddler SAZ íŒŒì¼ì„ ë¶„ì„í•˜ì—¬ Excel ë¦¬í¬íŠ¸ë¡œ ë³€í™˜**í•´ì£¼ëŠ” Python ê¸°ë°˜ íˆ´ì…ë‹ˆë‹¤.  
ì›¹ ë³´ì•ˆ ì ê²€Â·ì·¨ì•½ì  ì§„ë‹¨ ë³´ê³ ì„œ ì‘ì„± ì‹œ ë°˜ë³µì ì¸ íŒ¨í‚· ë¶„ì„ ì‘ì—…ì„ ìë™í™”í•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.

## í•´ë‹¹ ì½”ë“œ ì‹¤í–‰ ì‹œ SAZ íŒŒì¼ ìƒì„±
- ì§„ë‹¨ ì‹œ, íŒ¨í‚·ì„ ì„ íƒ í›„ ë§ˆìš°ìŠ¤ ìš°í´ë¦­ > Comment(ë‹¨ì¶•í‚¤ m)ì„ ì…ë ¥í•˜ì—¬ 'ì·¨ì•½', 'vuln', ë˜ëŠ” 'vulnerable'ì´ë¼ê³  ì…ë ¥í•©ë‹ˆë‹¤.
- ìœ„ì™€ ê°™ì´ commentë¥¼ ì…ë ¥ í•˜ê²Œ ë˜ë©´ ì—‘ì…€ ìƒì„± ì‹œ ì§„ë‹¨ ê²°ê³¼ê°€ 'ì·¨ì•½'ìœ¼ë¡œ ìë™ìœ¼ë¡œ ì…ë ¥ë©ë‹ˆë‹¤. ê·¸ëŸ¬í•˜ì§€ ì•Šì€ ê²½ìš°ëŠ” ëª¨ë‘ ì–‘í˜¸ë¡œ ì…ë ¥ë©ë‹ˆë‹¤.
- Fiddler > File > Save > All Sessions ë¥¼ ì´ìš©í•˜ì—¬ íŒŒì¼ì„ ì €ì¥í•©ë‹ˆë‹¤.
- í•´ë‹¹ .saz íŒŒì¼ì„ saz2xlsx.pyì™€ ê°™ì€ ë””ë ‰í† ë¦¬ì— ì €ì¥í•©ë‹ˆë‹¤.

## ì£¼ìš” ê¸°ëŠ¥

### 1. SAZ íŒŒì¼ íŒŒì‹±
- ìš”ì²­(Request)ì™€ ì‘ë‹µ(Response)ì„ ìë™ìœ¼ë¡œ íŒŒì‹±
- URL, HTTP ë©”ì„œë“œ, íŒŒë¼ë¯¸í„°, ìš”ì²­ ì‹œê°„, ì½”ë©˜íŠ¸ ê¸°ë°˜ ì·¨ì•½/ì–‘í˜¸ ì—¬ë¶€ ì¶”ì¶œ
- `CONNECT` ë©”ì„œë“œ, ì •ì  ìì‚°(js/css/png ë“±)ì€ ìë™ìœ¼ë¡œ ì œì™¸ ì²˜ë¦¬

### 2. ë©”ë‰´ëª… ìë™ ë¼ë²¨ë§
- `--menu-label` ì˜µì…˜ ì‚¬ìš© ì‹œ(ë””í´íŠ¸) HTML ë‚´ ë©”ë‰´ êµ¬ì¡°ë¥¼ íŒŒì‹±í•´ í›„ë³´ë¥¼ ìˆ˜ì§‘
- ìš”ì²­ URLê³¼ í›„ë³´ ë©”ë‰´ë¥¼ ìœ ì‚¬ë„ ê¸°ë°˜ìœ¼ë¡œ ë§¤ì¹­
- ì„ê³„ê°’(`--menu-threshold`) ì´í•˜ì¼ ê²½ìš° ë©”ë‰´ëª…ì€ ê³µë€ìœ¼ë¡œ ì²˜ë¦¬
- ë””ë²„ê·¸ ëª¨ë“œ(`--debug`)ì—ì„œë§Œ ë§¤ì¹­ ì ìˆ˜ì™€ ì¶”ì • ë©”ë‰´ëª…ì´ ë…¸ì¶œë¨

### 3. ì—‘ì…€ ë¦¬í¬íŠ¸ ìƒì„±
- í‘œì¤€ ì„œì‹ ì ìš©ëœ `.xlsx` íŒŒì¼ ì¶œë ¥
- ì˜µì…˜:
  - `--include-time`: ìš”ì²­ ì‹œê° ì»¬ëŸ¼ í¬í•¨
  - `--separate-by-url`: ë„ë©”ì¸ë³„ ì‹œíŠ¸ ë¶„ë¦¬
  - `--base-url`: ëŒ€í‘œ URLì„ ì²« í–‰ì— í‘œì‹œ
- ì»¬ëŸ¼ êµ¬ì„±
  - ê¸°ë³¸: ê²½ë¡œ, Method, ì§„ë‹¨ URL, íŒŒë¼ë¯¸í„°, ì§„ë‹¨ê²°ê³¼, ë¹„ê³ 
  - ë””ë²„ê·¸ ëª¨ë“œ: `ë©”ë‰´ëª…(ì¶”ì •)`, `ë§¤ì¹­ì ìˆ˜`, `ë¹„ê³ (ë§¤ì¹­ì ìˆ˜)` ì¶”ê°€

### 4. URL ì œì™¸ ê¸°ëŠ¥
- `--banned-file` ì˜µì…˜ìœ¼ë¡œ ì œì™¸í•  URLì„ ê´€ë¦¬ ê°€ëŠ¥
- ì§€ì› í˜•ì‹:
  - prefix (ì˜ˆ: `/common`)
  - ì •ê·œì‹ (ì˜ˆ: `re:^/test/.*`)

### 5. ì§„í–‰ í‘œì‹œ
- ëŒ€ëŸ‰ì˜ ì„¸ì…˜ ì²˜ë¦¬ ì‹œ ì§„í–‰ë¥ , ETA í‘œì‹œ
- `-p` ë˜ëŠ” `--progress` ì˜µì…˜ ì‚¬ìš©
- `--progress-every`ë¡œ ì—…ë°ì´íŠ¸ ì£¼ê¸° ì„¤ì • ê°€ëŠ¥ (ê¸°ë³¸ 200ê°œ)

---

## ì„¤ì¹˜ ë° ì‹¤í–‰

### 1) ì˜ì¡´ì„±
```bash
pip install pandas openpyxl
```

### 2) ì‹¤í–‰ ì˜ˆì‹œ
```bash
# ê¸°ë³¸ ì‹¤í–‰
python saz2xlsx.py input.saz -o report.xlsx

# ë„ë©”ì¸ë³„ ì‹œíŠ¸ ë¶„ë¦¬ + ì‹œê° í‘œì‹œ
python saz2xlsx.py input.saz --include-time --separate-by-url -o report_split.xlsx
```

---

## í”„ë¡œì íŠ¸ êµ¬ì¡°

```
project/
 â”œâ”€ saz2xlsx.py           # ë©”ì¸ CLI ì—”íŠ¸ë¦¬í¬ì¸íŠ¸
 â””â”€ scripts/              # ëª¨ë“ˆ ëª¨ìŒ
     â”œâ”€ saz_parser.py     # SAZ íŒŒì¼ íŒŒì„œ (í–‰ ë°ì´í„° ìƒì„±)
     â”œâ”€ excel_exporter.py # Excel ì¶œë ¥/ì„œì‹
     â”œâ”€ http_utils.py     # HTTP ìš”ì²­ íŒŒì‹±, íŒŒë¼ë¯¸í„° ì¶”ì¶œ, ë¬¸ìì—´ ì •í™”
     â”œâ”€ metadata_utils.py # Fiddler ë©”íƒ€ë°ì´í„° ë¶„ì„ (ì½”ë©˜íŠ¸, ì‹œê°„)
     â”œâ”€ filters.py        # ì •ì  ìì‚° í•„í„°ë§, banned ë¦¬ìŠ¤íŠ¸ ê´€ë¦¬
     â”œâ”€ progress_utils.py # ì§„í–‰ í‘œì‹œ/ETA ê³„ì‚°
     â””â”€ menu_auto_label.py (ì„ íƒ) # ë©”ë‰´ í›„ë³´ ìˆ˜ì§‘ ë° ë§¤ì¹­ ë¡œì§
```

---

## ìœ ì§€ë³´ìˆ˜/ê°œë°œììš© ì •ë¦¬

### 1. `saz_parser.py`
- ì±…ì„: SAZ(zip) ì—´ê³  `_c.txt` ìš”ì²­ íŒŒì‹± â†’ í–‰ ë”•ì…”ë„ˆë¦¬ ìƒì„±
- ì£¼ìš” í•¨ìˆ˜:
  - `parse_saz_data(...)`
- ë‚´ë¶€ì—ì„œ ì‚¬ìš©í•˜ëŠ” ëª¨ë“ˆ:
  - `http_utils` (ìš”ì²­/íŒŒë¼ë¯¸í„° ì²˜ë¦¬)
  - `metadata_utils` (ì·¨ì•½/ì‹œê°„ ì¶”ì¶œ)
  - `filters` (ì •ì  ìì‚° í•„í„°)
  - `menu_auto_label` (ì˜µì…˜)

### 2. `excel_exporter.py`
- ì±…ì„: DataFrame â†’ Excel(.xlsx) ë³€í™˜
- ê¸°ëŠ¥:
  - ì‹œíŠ¸ë³„ ë¶„ë¦¬/ì„œì‹
  - ì»¬ëŸ¼ width ìë™ ì¡°ì •
- ë””ë²„ê·¸ ëª¨ë“œ ì—¬ë¶€ì— ë”°ë¼ ì»¬ëŸ¼ êµ¬ì„±ì´ ë‹¬ë¼ì§

### 3. `http_utils.py`
- ì±…ì„: HTTP ìš”ì²­/ì‘ë‹µ ê´€ë ¨ ìœ í‹¸
- ê¸°ëŠ¥:
  - `parse_request`: method, target, headers, body ì¶”ì¶œ
  - `extract_params`: URL/í¼/JSON íŒŒë¼ë¯¸í„° ì¶”ì¶œ
  - `make_breadcrumb`: URL â†’ [path] > [path] ë³€í™˜
  - `sanitize_excel_str`: Excel ê¸ˆì§€ ë¬¸ì ì œê±°
  - `parse_iso_to_kst`: ISO â†’ KST ì‹œê° ë³€í™˜

### 4. `metadata_utils.py`
- ì±…ì„: `_m.xml`, `_m.json`ì—ì„œ ë©”íƒ€ë°ì´í„° ë¶„ì„
- ê¸°ëŠ¥:
  - `is_marked_vulnerable_by_comment`: ì½”ë©˜íŠ¸ í‚¤ì›Œë“œ ê¸°ë°˜ ì·¨ì•½ ì—¬ë¶€ íŒì •
  - `extract_request_time_kst`: ìš”ì²­ ì‹œê° ì¶”ì¶œ

### 5. `filters.py`
- ì±…ì„: ìš”ì²­ ì œì™¸ ë¡œì§
- ê¸°ëŠ¥:
  - `is_probable_asset`: js/css/png ë“± ì •ì  ìì‚° ìë™ ì œì™¸
  - `parse_banned_file`, `compile_ignores`, `filter_sessions`

### 6. `progress_utils.py`
- ì±…ì„: CLI ì§„í–‰ í‘œì‹œ
- í•¨ìˆ˜:
  - `progress_start`
  - `progress_update`
  - `progress_end`

### 7. `menu_auto_label.py` 
- ì±…ì„: HTML ë‚´ ë©”ë‰´ êµ¬ì¡° ì¶”ì¶œ & ìš”ì²­ URLê³¼ ë§¤ì¹­
- í•¨ìˆ˜:
  - `build_candidate_pool_from_saz`
  - `best_menu_for_url`
